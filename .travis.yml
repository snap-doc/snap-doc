sudo: false
language: node_js
# cache:
#   directories:
#     - node_modules
notifications:
  email: false
node_js:
  - '10'
git:
  depth: 1
after_install: npm run ci:setup_env
# after_success: npm run ci:after_success

stages:
  - basic
  - name: deploy
    if: branch = master AND type = push

jobs:
  include:
    - stage: basic
      script: lerna run test
    - stage: deploy
      name: 'Publish to npm'
      script: .travis/_publish.sh
